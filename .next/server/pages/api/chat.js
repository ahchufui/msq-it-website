"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/chat";
exports.ids = ["pages/api/chat"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@azure/openai":
/*!********************************!*\
  !*** external "@azure/openai" ***!
  \********************************/
/***/ ((module) => {

module.exports = import("@azure/openai");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat.js&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat.js&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\chat.js */ \"(api)/./pages/api/chat.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/chat\",\n        pathname: \"/api/chat\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_chat_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNoYXQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2NoYXQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDa0Q7QUFDbEQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLCtDQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQywrQ0FBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tc3EtaXQtd2Vic2l0ZS8/ODU4ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXGNoYXQuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/chat.js":
/*!***************************!*\
  !*** ./pages/api/chat.js ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _azure_openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @azure/openai */ \"@azure/openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_azure_openai__WEBPACK_IMPORTED_MODULE_0__]);\n_azure_openai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// Next.js API route support: https://nextjs.org/docs/api-routes/introduction\n\nasync function handler(req, res) {\n    // Only allow POST requests\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const { message, chatHistory } = req.body;\n        // Check if Azure OpenAI credentials are configured\n        const apiKey = process.env.AZURE_OPENAI_API_KEY;\n        const endpoint = process.env.AZURE_OPENAI_ENDPOINT;\n        const deploymentName = process.env.AZURE_OPENAI_DEPLOYMENT_NAME;\n        // If Azure OpenAI is not configured, fall back to rule-based system\n        if (!apiKey || !endpoint || !deploymentName) {\n            console.warn(\"Azure OpenAI credentials not configured, falling back to rule-based system\");\n            return res.status(200).json({\n                response: getRuleBasedResponse(message)\n            });\n        }\n        // Initialize Azure OpenAI client\n        const client = new _azure_openai__WEBPACK_IMPORTED_MODULE_0__.OpenAIClient(endpoint, new _azure_openai__WEBPACK_IMPORTED_MODULE_0__.AzureKeyCredential(apiKey));\n        // Format chat history for Azure OpenAI\n        const formattedHistory = chatHistory ? chatHistory.map((msg)=>({\n                role: msg.role,\n                content: msg.content\n            })) : [];\n        // Prepare messages array with system message and chat history\n        const messages = [\n            {\n                role: \"system\",\n                content: `You are an AI assistant for MSQ IT, a managed services provider based in Brisbane, Australia. \n        You specialize in Microsoft 365, Azure, cybersecurity, ERP systems (especially Microsoft Dynamics 365 Business Central), \n        and general IT support for small to medium businesses. \n        Be helpful, professional, and concise. Always offer practical solutions to IT problems. \n        If you don't know something, suggest contacting the MSQ IT support team at support@msqit.com.au or (07) XXXX XXXX. \n        Do not make up information about MSQ IT's specific clients or internal processes.`\n            },\n            ...formattedHistory,\n            {\n                role: \"user\",\n                content: message\n            }\n        ];\n        // Call Azure OpenAI API\n        const result = await client.getChatCompletions(deploymentName, messages, {\n            maxTokens: 500,\n            temperature: 0.7\n        });\n        // Extract response\n        const response = result.choices[0].message.content;\n        return res.status(200).json({\n            response\n        });\n    } catch (error) {\n        console.error(\"Error in chat API:\", error);\n        // If there's an error with the Azure OpenAI service, fall back to rule-based system\n        if (error.message && (error.message.includes(\"Azure\") || error.message.includes(\"OpenAI\"))) {\n            console.warn(\"Error with Azure OpenAI, falling back to rule-based system\");\n            return res.status(200).json({\n                response: getRuleBasedResponse(req.body.message),\n                fallback: true\n            });\n        }\n        return res.status(500).json({\n            error: \"Internal server error\"\n        });\n    }\n}\n// Fallback rule-based system\nfunction getRuleBasedResponse(message) {\n    const lowerCaseMessage = message.toLowerCase();\n    if (lowerCaseMessage.includes(\"password\") && lowerCaseMessage.includes(\"reset\")) {\n        return \"I can help with password resets! Would you like me to guide you through our self-service password reset process or create a support ticket for you?\";\n    } else if (lowerCaseMessage.includes(\"microsoft\") || lowerCaseMessage.includes(\"365\") || lowerCaseMessage.includes(\"office\")) {\n        return \"We provide comprehensive Microsoft 365 services including tenant configuration, email migration, and ongoing support. Would you like more information about our Microsoft services?\";\n    } else if (lowerCaseMessage.includes(\"security\") || lowerCaseMessage.includes(\"cybersecurity\") || lowerCaseMessage.includes(\"cyber\")) {\n        return \"Security is our priority! We offer enterprise-grade cybersecurity solutions for small to medium businesses, including email protection, endpoint security, and security assessments. How can we help with your security needs?\";\n    } else if (lowerCaseMessage.includes(\"erp\") || lowerCaseMessage.includes(\"dynamics\") || lowerCaseMessage.includes(\"business central\")) {\n        return \"Our team has strong expertise in Microsoft Dynamics 365 Business Central and Wiise ERP implementations. We can help streamline your operations with these powerful tools. Would you like to discuss your ERP needs?\";\n    } else if (lowerCaseMessage.includes(\"contact\") || lowerCaseMessage.includes(\"speak\") || lowerCaseMessage.includes(\"human\")) {\n        return \"I'd be happy to connect you with our team! You can reach us at support@msqit.com.au or call (07) XXXX XXXX during business hours (Mon-Fri, 8AM-5PM). Would you like me to create a support ticket for you instead?\";\n    } else if (lowerCaseMessage.includes(\"thank\")) {\n        return \"You're welcome! Is there anything else I can help you with today?\";\n    } else if (lowerCaseMessage.includes(\"bye\") || lowerCaseMessage.includes(\"goodbye\")) {\n        return \"Thank you for chatting with MSQ IT's virtual assistant. Have a great day!\";\n    } else {\n        return \"I'm still learning! For specific assistance, please contact our support team at support@msqit.com.au or call (07) XXXX XXXX. Alternatively, I can create a support ticket for you. Would you like me to do that?\";\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGlCQUFpQkYsUUFBUSxDQUFDLGVBQWVFLGlCQUFpQkYsUUFBUSxDQUFDLG9CQUFvQkUsaUJBQWlCRixRQUFRLENBQUMsVUFBVTtRQUNwSSxPQUFPO0lBQ1QsT0FBTyxJQUFJRSxpQkFBaUJGLFFBQVEsQ0FBQyxVQUFVRSxpQkFBaUJGLFFBQVEsQ0FBQyxlQUFlRSxpQkFBaUJGLFFBQVEsQ0FBQyxxQkFBcUI7UUFDckksT0FBTztJQUNULE9BQU8sSUFBSUUsaUJBQWlCRixRQUFRLENBQUMsY0FBY0UsaUJBQWlCRixRQUFRLENBQUMsWUFBWUUsaUJBQWlCRixRQUFRLENBQUMsVUFBVTtRQUMzSCxPQUFPO0lBQ1QsT0FBTyxJQUFJRSxpQkFBaUJGLFFBQVEsQ0FBQyxVQUFVO1FBQzdDLE9BQU87SUFDVCxPQUFPLElBQUlFLGlCQUFpQkYsUUFBUSxDQUFDLFVBQVVFLGlCQUFpQkYsUUFBUSxDQUFDLFlBQVk7UUFDbkYsT0FBTztJQUNULE9BQU87UUFDTCxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21zcS1pdC13ZWJzaXRlLy4vcGFnZXMvYXBpL2NoYXQuanM/MWM0OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBOZXh0LmpzIEFQSSByb3V0ZSBzdXBwb3J0OiBodHRwczovL25leHRqcy5vcmcvZG9jcy9hcGktcm91dGVzL2ludHJvZHVjdGlvblxuaW1wb3J0IHsgT3BlbkFJQ2xpZW50LCBBenVyZUtleUNyZWRlbnRpYWwgfSBmcm9tIFwiQGF6dXJlL29wZW5haVwiO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIC8vIE9ubHkgYWxsb3cgUE9TVCByZXF1ZXN0c1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IG1lc3NhZ2UsIGNoYXRIaXN0b3J5IH0gPSByZXEuYm9keTtcblxuICAgIC8vIENoZWNrIGlmIEF6dXJlIE9wZW5BSSBjcmVkZW50aWFscyBhcmUgY29uZmlndXJlZFxuICAgIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LkFaVVJFX09QRU5BSV9BUElfS0VZO1xuICAgIGNvbnN0IGVuZHBvaW50ID0gcHJvY2Vzcy5lbnYuQVpVUkVfT1BFTkFJX0VORFBPSU5UO1xuICAgIGNvbnN0IGRlcGxveW1lbnROYW1lID0gcHJvY2Vzcy5lbnYuQVpVUkVfT1BFTkFJX0RFUExPWU1FTlRfTkFNRTtcblxuICAgIC8vIElmIEF6dXJlIE9wZW5BSSBpcyBub3QgY29uZmlndXJlZCwgZmFsbCBiYWNrIHRvIHJ1bGUtYmFzZWQgc3lzdGVtXG4gICAgaWYgKCFhcGlLZXkgfHwgIWVuZHBvaW50IHx8ICFkZXBsb3ltZW50TmFtZSkge1xuICAgICAgY29uc29sZS53YXJuKCdBenVyZSBPcGVuQUkgY3JlZGVudGlhbHMgbm90IGNvbmZpZ3VyZWQsIGZhbGxpbmcgYmFjayB0byBydWxlLWJhc2VkIHN5c3RlbScpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgcmVzcG9uc2U6IGdldFJ1bGVCYXNlZFJlc3BvbnNlKG1lc3NhZ2UpIH0pO1xuICAgIH1cblxuICAgIC8vIEluaXRpYWxpemUgQXp1cmUgT3BlbkFJIGNsaWVudFxuICAgIGNvbnN0IGNsaWVudCA9IG5ldyBPcGVuQUlDbGllbnQoXG4gICAgICBlbmRwb2ludCxcbiAgICAgIG5ldyBBenVyZUtleUNyZWRlbnRpYWwoYXBpS2V5KVxuICAgICk7XG5cbiAgICAvLyBGb3JtYXQgY2hhdCBoaXN0b3J5IGZvciBBenVyZSBPcGVuQUlcbiAgICBjb25zdCBmb3JtYXR0ZWRIaXN0b3J5ID0gY2hhdEhpc3RvcnkgPyBjaGF0SGlzdG9yeS5tYXAobXNnID0+ICh7XG4gICAgICByb2xlOiBtc2cucm9sZSxcbiAgICAgIGNvbnRlbnQ6IG1zZy5jb250ZW50XG4gICAgfSkpIDogW107XG5cbiAgICAvLyBQcmVwYXJlIG1lc3NhZ2VzIGFycmF5IHdpdGggc3lzdGVtIG1lc3NhZ2UgYW5kIGNoYXQgaGlzdG9yeVxuICAgIGNvbnN0IG1lc3NhZ2VzID0gW1xuICAgICAge1xuICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxuICAgICAgICBjb250ZW50OiBgWW91IGFyZSBhbiBBSSBhc3Npc3RhbnQgZm9yIE1TUSBJVCwgYSBtYW5hZ2VkIHNlcnZpY2VzIHByb3ZpZGVyIGJhc2VkIGluIEJyaXNiYW5lLCBBdXN0cmFsaWEuIFxuICAgICAgICBZb3Ugc3BlY2lhbGl6ZSBpbiBNaWNyb3NvZnQgMzY1LCBBenVyZSwgY3liZXJzZWN1cml0eSwgRVJQIHN5c3RlbXMgKGVzcGVjaWFsbHkgTWljcm9zb2Z0IER5bmFtaWNzIDM2NSBCdXNpbmVzcyBDZW50cmFsKSwgXG4gICAgICAgIGFuZCBnZW5lcmFsIElUIHN1cHBvcnQgZm9yIHNtYWxsIHRvIG1lZGl1bSBidXNpbmVzc2VzLiBcbiAgICAgICAgQmUgaGVscGZ1bCwgcHJvZmVzc2lvbmFsLCBhbmQgY29uY2lzZS4gQWx3YXlzIG9mZmVyIHByYWN0aWNhbCBzb2x1dGlvbnMgdG8gSVQgcHJvYmxlbXMuIFxuICAgICAgICBJZiB5b3UgZG9uJ3Qga25vdyBzb21ldGhpbmcsIHN1Z2dlc3QgY29udGFjdGluZyB0aGUgTVNRIElUIHN1cHBvcnQgdGVhbSBhdCBzdXBwb3J0QG1zcWl0LmNvbS5hdSBvciAoMDcpIFhYWFggWFhYWC4gXG4gICAgICAgIERvIG5vdCBtYWtlIHVwIGluZm9ybWF0aW9uIGFib3V0IE1TUSBJVCdzIHNwZWNpZmljIGNsaWVudHMgb3IgaW50ZXJuYWwgcHJvY2Vzc2VzLmBcbiAgICAgIH0sXG4gICAgICAuLi5mb3JtYXR0ZWRIaXN0b3J5LFxuICAgICAge1xuICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgY29udGVudDogbWVzc2FnZVxuICAgICAgfVxuICAgIF07XG5cbiAgICAvLyBDYWxsIEF6dXJlIE9wZW5BSSBBUElcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQuZ2V0Q2hhdENvbXBsZXRpb25zKFxuICAgICAgZGVwbG95bWVudE5hbWUsXG4gICAgICBtZXNzYWdlcyxcbiAgICAgIHtcbiAgICAgICAgbWF4VG9rZW5zOiA1MDAsXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICB9XG4gICAgKTtcblxuICAgIC8vIEV4dHJhY3QgcmVzcG9uc2VcbiAgICBjb25zdCByZXNwb25zZSA9IHJlc3VsdC5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcblxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IHJlc3BvbnNlIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGNoYXQgQVBJOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBJZiB0aGVyZSdzIGFuIGVycm9yIHdpdGggdGhlIEF6dXJlIE9wZW5BSSBzZXJ2aWNlLCBmYWxsIGJhY2sgdG8gcnVsZS1iYXNlZCBzeXN0ZW1cbiAgICBpZiAoZXJyb3IubWVzc2FnZSAmJiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnQXp1cmUnKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdPcGVuQUknKSkpIHtcbiAgICAgIGNvbnNvbGUud2FybignRXJyb3Igd2l0aCBBenVyZSBPcGVuQUksIGZhbGxpbmcgYmFjayB0byBydWxlLWJhc2VkIHN5c3RlbScpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICAgIHJlc3BvbnNlOiBnZXRSdWxlQmFzZWRSZXNwb25zZShyZXEuYm9keS5tZXNzYWdlKSxcbiAgICAgICAgZmFsbGJhY2s6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSk7XG4gIH1cbn1cblxuLy8gRmFsbGJhY2sgcnVsZS1iYXNlZCBzeXN0ZW1cbmZ1bmN0aW9uIGdldFJ1bGVCYXNlZFJlc3BvbnNlKG1lc3NhZ2UpIHtcbiAgY29uc3QgbG93ZXJDYXNlTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKTtcbiAgXG4gIGlmIChsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCdwYXNzd29yZCcpICYmIGxvd2VyQ2FzZU1lc3NhZ2UuaW5jbHVkZXMoJ3Jlc2V0JykpIHtcbiAgICByZXR1cm4gXCJJIGNhbiBoZWxwIHdpdGggcGFzc3dvcmQgcmVzZXRzISBXb3VsZCB5b3UgbGlrZSBtZSB0byBndWlkZSB5b3UgdGhyb3VnaCBvdXIgc2VsZi1zZXJ2aWNlIHBhc3N3b3JkIHJlc2V0IHByb2Nlc3Mgb3IgY3JlYXRlIGEgc3VwcG9ydCB0aWNrZXQgZm9yIHlvdT9cIjtcbiAgfSBlbHNlIGlmIChsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCdtaWNyb3NvZnQnKSB8fCBsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCczNjUnKSB8fCBsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCdvZmZpY2UnKSkge1xuICAgIHJldHVybiBcIldlIHByb3ZpZGUgY29tcHJlaGVuc2l2ZSBNaWNyb3NvZnQgMzY1IHNlcnZpY2VzIGluY2x1ZGluZyB0ZW5hbnQgY29uZmlndXJhdGlvbiwgZW1haWwgbWlncmF0aW9uLCBhbmQgb25nb2luZyBzdXBwb3J0LiBXb3VsZCB5b3UgbGlrZSBtb3JlIGluZm9ybWF0aW9uIGFib3V0IG91ciBNaWNyb3NvZnQgc2VydmljZXM/XCI7XG4gIH0gZWxzZSBpZiAobG93ZXJDYXNlTWVzc2FnZS5pbmNsdWRlcygnc2VjdXJpdHknKSB8fCBsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCdjeWJlcnNlY3VyaXR5JykgfHwgbG93ZXJDYXNlTWVzc2FnZS5pbmNsdWRlcygnY3liZXInKSkge1xuICAgIHJldHVybiBcIlNlY3VyaXR5IGlzIG91ciBwcmlvcml0eSEgV2Ugb2ZmZXIgZW50ZXJwcmlzZS1ncmFkZSBjeWJlcnNlY3VyaXR5IHNvbHV0aW9ucyBmb3Igc21hbGwgdG8gbWVkaXVtIGJ1c2luZXNzZXMsIGluY2x1ZGluZyBlbWFpbCBwcm90ZWN0aW9uLCBlbmRwb2ludCBzZWN1cml0eSwgYW5kIHNlY3VyaXR5IGFzc2Vzc21lbnRzLiBIb3cgY2FuIHdlIGhlbHAgd2l0aCB5b3VyIHNlY3VyaXR5IG5lZWRzP1wiO1xuICB9IGVsc2UgaWYgKGxvd2VyQ2FzZU1lc3NhZ2UuaW5jbHVkZXMoJ2VycCcpIHx8IGxvd2VyQ2FzZU1lc3NhZ2UuaW5jbHVkZXMoJ2R5bmFtaWNzJykgfHwgbG93ZXJDYXNlTWVzc2FnZS5pbmNsdWRlcygnYnVzaW5lc3MgY2VudHJhbCcpKSB7XG4gICAgcmV0dXJuIFwiT3VyIHRlYW0gaGFzIHN0cm9uZyBleHBlcnRpc2UgaW4gTWljcm9zb2Z0IER5bmFtaWNzIDM2NSBCdXNpbmVzcyBDZW50cmFsIGFuZCBXaWlzZSBFUlAgaW1wbGVtZW50YXRpb25zLiBXZSBjYW4gaGVscCBzdHJlYW1saW5lIHlvdXIgb3BlcmF0aW9ucyB3aXRoIHRoZXNlIHBvd2VyZnVsIHRvb2xzLiBXb3VsZCB5b3UgbGlrZSB0byBkaXNjdXNzIHlvdXIgRVJQIG5lZWRzP1wiO1xuICB9IGVsc2UgaWYgKGxvd2VyQ2FzZU1lc3NhZ2UuaW5jbHVkZXMoJ2NvbnRhY3QnKSB8fCBsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCdzcGVhaycpIHx8IGxvd2VyQ2FzZU1lc3NhZ2UuaW5jbHVkZXMoJ2h1bWFuJykpIHtcbiAgICByZXR1cm4gXCJJJ2QgYmUgaGFwcHkgdG8gY29ubmVjdCB5b3Ugd2l0aCBvdXIgdGVhbSEgWW91IGNhbiByZWFjaCB1cyBhdCBzdXBwb3J0QG1zcWl0LmNvbS5hdSBvciBjYWxsICgwNykgWFhYWCBYWFhYIGR1cmluZyBidXNpbmVzcyBob3VycyAoTW9uLUZyaSwgOEFNLTVQTSkuIFdvdWxkIHlvdSBsaWtlIG1lIHRvIGNyZWF0ZSBhIHN1cHBvcnQgdGlja2V0IGZvciB5b3UgaW5zdGVhZD9cIjtcbiAgfSBlbHNlIGlmIChsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCd0aGFuaycpKSB7XG4gICAgcmV0dXJuIFwiWW91J3JlIHdlbGNvbWUhIElzIHRoZXJlIGFueXRoaW5nIGVsc2UgSSBjYW4gaGVscCB5b3Ugd2l0aCB0b2RheT9cIjtcbiAgfSBlbHNlIGlmIChsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCdieWUnKSB8fCBsb3dlckNhc2VNZXNzYWdlLmluY2x1ZGVzKCdnb29kYnllJykpIHtcbiAgICByZXR1cm4gXCJUaGFuayB5b3UgZm9yIGNoYXR0aW5nIHdpdGggTVNRIElUJ3MgdmlydHVhbCBhc3Npc3RhbnQuIEhhdmUgYSBncmVhdCBkYXkhXCI7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFwiSSdtIHN0aWxsIGxlYXJuaW5nISBGb3Igc3BlY2lmaWMgYXNzaXN0YW5jZSwgcGxlYXNlIGNvbnRhY3Qgb3VyIHN1cHBvcnQgdGVhbSBhdCBzdXBwb3J0QG1zcWl0LmNvbS5hdSBvciBjYWxsICgwNykgWFhYWCBYWFhYLiBBbHRlcm5hdGl2ZWx5LCBJIGNhbiBjcmVhdGUgYSBzdXBwb3J0IHRpY2tldCBmb3IgeW91LiBXb3VsZCB5b3UgbGlrZSBtZSB0byBkbyB0aGF0P1wiO1xuICB9XG59XG4iXSwibmFtZXMiOlsiT3BlbkFJQ2xpZW50IiwiQXp1cmVLZXlDcmVkZW50aWFsIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsIm1lc3NhZ2UiLCJjaGF0SGlzdG9yeSIsImJvZHkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiQVpVUkVfT1BFTkFJX0FQSV9LRVkiLCJlbmRwb2ludCIsIkFaVVJFX09QRU5BSV9FTkRQT0lOVCIsImRlcGxveW1lbnROYW1lIiwiQVpVUkVfT1BFTkFJX0RFUExPWU1FTlRfTkFNRSIsImNvbnNvbGUiLCJ3YXJuIiwicmVzcG9uc2UiLCJnZXRSdWxlQmFzZWRSZXNwb25zZSIsImNsaWVudCIsImZvcm1hdHRlZEhpc3RvcnkiLCJtYXAiLCJtc2ciLCJyb2xlIiwiY29udGVudCIsIm1lc3NhZ2VzIiwicmVzdWx0IiwiZ2V0Q2hhdENvbXBsZXRpb25zIiwibWF4VG9rZW5zIiwidGVtcGVyYXR1cmUiLCJjaG9pY2VzIiwiaW5jbHVkZXMiLCJmYWxsYmFjayIsImxvd2VyQ2FzZU1lc3NhZ2UiLCJ0b0xvd2VyQ2FzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/chat.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();